<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>NewMenuItem.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: NewMenuItem.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import { Database } from &quot;./Database.js&quot;;

/**
 * It takes in an array of strings and calls the addNewItem method
 */
class NewMenuItem {
  constructor() {
    this.db = new Database();
  }

  async displayItem() {
    await this.db.connect();
    let result = null;
    try {
      const sqlStatement = &#x60;SELECT * FROM bridge;&#x60;;
      result = await this.db.query(sqlStatement);
    } catch (e) {
      console.error(e);
      process.exit(0);
    }
    await this.db.disconnect();
    return result; // return the rows from the result object
  }

  async addNewItem(itemName, ingredients) {
    let seperatedIngredients = new Array(3);
    let newIngredientsArray_2 = ingredients.split(&quot;,&quot;);
    let Ingredients = &quot;&quot;;
    let size = 0;

    for (let c of newIngredientsArray_2) {
      size++;
    }

    let newIngredientsArray = new Array(size).fill(0).map(() =&gt; new Array(3));

    for (let i = 0; i &lt; size; i++) {
      seperatedIngredients = newIngredientsArray_2[i].split(&quot;-&quot;);
      newIngredientsArray[i] = seperatedIngredients;
    }

    for (let c of newIngredientsArray) {
      Ingredients += c[0] + &quot;, &quot;;
    }
    // String of all Items
    Ingredients = Ingredients.substring(0, Ingredients.length - 2);

    try {
      // Inserting new Item into Bridge in database
      this.db.connect();
      console.log(&quot;Opened database successfully&quot;);
      let sqlStatement = &#x60;SELECT COUNT(*) FROM bridge WHERE item=&#x27;${itemName}&#x27;;&#x60;;
      const res = await this.db.query(sqlStatement);
      const num = res[0].count;
      if (num == 0) {
        sqlStatement =
          &quot;INSERT INTO Bridge (item, ingredients) VALUES (&#x27;&quot; +
          itemName +
          &quot;&#x27;, &#x27;{&quot; +
          Ingredients +
          &quot;}&#x27;)&quot;;
        await this.db.query(sqlStatement);
      } else {
        sqlStatement = &#x60;DELETE FROM Bridge WHERE item IN(&#x27;${itemName}&#x27;)&#x60;;
        await this.db.query(sqlStatement);
        sqlStatement =
          &quot;INSERT INTO Bridge (item, ingredients) VALUES (&#x27;&quot; +
          itemName +
          &quot;&#x27;, &#x27;{&quot; +
          Ingredients +
          &quot;}&#x27;)&quot;;
        await this.db.query(sqlStatement);
      }

      // Check if all items are in ingredients table in database
      for (const c of newIngredientsArray) {
        const Ingredient = c[0];
        const Unit = c[1];
        const Type = c[2];
        sqlStatement = &#x60;SELECT COUNT(*) FROM ingredients WHERE ingredient =&#x27;${Ingredient}&#x27;&#x60;;

        // call methods that might throw SQLException
        const result_1 = await this.db.query(sqlStatement);
        const count = result_1[0].count;
        // add item if it doesn&#x27;t exists

        if (count == 0) {
          sqlStatement = &#x60;INSERT INTO ingredients (Ingredient, Quantity, Unit, Type) VALUES (&#x27;${Ingredient}&#x27;, 500, &#x27;${Unit}&#x27;, &#x27;${Type}&#x27;)&#x60;;
          await this.db.query(sqlStatement);
        }
      }

      await this.db.disconnect();
    } catch (e) {
      console.log(e);
    }
  }
}

export { NewMenuItem };

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
